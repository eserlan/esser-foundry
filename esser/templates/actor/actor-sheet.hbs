<form class="esser-sheet {{cssClass}}" autocomplete="off">
  <section class="sheet-body">
    <header class="esser-header card">
      <div class="header-grid">
        <div class="portrait-frame">
          <button
            type="button"
            class="portrait-button"
            data-action="edit-image"
            data-edit="img"
            aria-label="{{localize 'ESSER.CharacterPortrait'}}"
            title="{{localize 'ESSER.CharacterPortrait'}}"
          >
            <img src="{{actor.img}}" alt="{{actor.name}}" />
          </button>
          <button
            type="button"
            class="portrait-viewer"
            data-action="view-image"
            aria-label="{{localize 'ESSER.ViewPortrait'}}"
            title="{{localize 'ESSER.ViewPortrait'}}"
          >
            <span aria-hidden="true">üñºÔ∏è</span>
          </button>
        </div>
        <div class="identity">
          <label class="field-label" for="esser-actor-name-{{actor._id}}">{{localize "ESSER.CharacterName"}}</label>
          <input
            id="esser-actor-name-{{actor._id}}"
            class="actor-name"
            name="name"
            type="text"
            value="{{actor.name}}"
            placeholder="{{localize 'ESSER.CharacterName'}}"
          />

          <label class="field-label" for="esser-actor-concept-{{actor._id}}">{{localize "ESSER.Concept"}}</label>
          <input
            id="esser-actor-concept-{{actor._id}}"
            class="actor-concept"
            type="text"
            name="system.concept"
            value="{{system.concept}}"
            placeholder="{{localize 'ESSER.Concept'}}"
          />
        </div>
        <div class="strikes-panel">
          <span class="panel-label">{{localize "ESSER.Strikes"}}</span>
          <div class="strike-controls">
            <button type="button" class="strike-button" data-action="strike-dec" aria-label="{{localize 'ESSER.ReduceStrike'}}">‚àí</button>
            <input
              class="strike-value"
              type="number"
              name="system.strikes"
              data-dtype="Number"
              value="{{system.strikes}}"
              min="0"
              max="{{system.maxStrikes}}"
            />
            <button type="button" class="strike-button" data-action="strike-inc" aria-label="{{localize 'ESSER.IncreaseStrike'}}">+</button>
          </div>
          <meter
            class="strike-meter"
            min="0"
            max="{{system.maxStrikes}}"
            value="{{system.strikes}}"
            title="{{system.strikes}} / {{system.maxStrikes}}"
          ></meter>
          <div class="strike-meta">
            <label class="max-strikes" for="esser-actor-max-strikes-{{actor._id}}">
              <span>{{localize "ESSER.MaxStrikes"}}</span>
              <input
                id="esser-actor-max-strikes-{{actor._id}}"
                type="number"
                name="system.maxStrikes"
                data-dtype="Number"
                value="{{system.maxStrikes}}"
                min="1"
              />
            </label>
            <span class="strike-count">{{system.strikes}} / {{system.maxStrikes}}</span>
          </div>
        </div>
      </div>
    </header>

    <section class="sheet-columns">
      <section class="attributes card">
        <header class="section-header">
          <h2>{{localize "ESSER.Attributes"}}</h2>
          <p>{{localize "ESSER.AttributesHint"}}</p>
        </header>
        <div class="attribute-groups">
          {{#each skillGroups}}
          <article class="attribute-block">
            <header class="attribute-header">
              <div class="attribute-meta">
                <label class="attribute-label" for="esser-actor-attribute-{{../actor._id}}-{{this.key}}">{{this.label}}</label>
                <select
                  id="esser-actor-attribute-{{../actor._id}}-{{this.key}}"
                  class="attribute-select"
                  name="system.attributes.{{this.key}}"
                  data-dtype="Number"
                >
                  {{#each this.ranks}}
                  <option value="{{this.value}}" {{#if this.selected}}selected{{/if}}>{{this.label}}</option>
                  {{/each}}
                </select>
              </div>
              <p class="attribute-description">{{this.description}}</p>
            </header>
            <div class="skills-grid">
              {{#each this.skills}}
              <div class="skill-row">
                <button
                  type="button"
                  class="roll-button"
                  data-action="roll-skill"
                  data-skill="{{this.key}}"
                  aria-label="{{localize 'ESSER.RollSkill' label=this.label}}"
                >üé≤</button>
                <div class="skill-info">
                  <span class="skill-label">{{this.label}}</span>
                  <span class="skill-key">{{this.key}}</span>
                </div>
                <select class="skill-select" name="system.skills.{{this.key}}" data-dtype="Number">
                  {{#each this.ranks}}
                  <option value="{{this.value}}" {{#if this.selected}}selected{{/if}}>{{this.label}}</option>
                  {{/each}}
                </select>
              </div>
              {{/each}}
            </div>
          </article>
          {{/each}}
        </div>
      </section>

      <aside class="notes card">
        <h2>{{localize "ESSER.Notes"}}</h2>
        <textarea
          name="system.notes"
          rows="12"
          placeholder="{{localize 'ESSER.NotesPlaceholder'}}"
        >{{system.notes}}</textarea>
      </aside>
    </section>
  </section>
</form>
